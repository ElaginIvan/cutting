<div class="instructions-container">
    <h3>0001. Введение</h3>
    <p>Приложение "Линейный Раскрой" предназначено для оптимизации раскроя длинномерных материалов (арматура, профиль, трубы и т.д.) на заготовки заданных размеров. Оно помогает минимизировать отходы, эффективно использовать остатки и вести учет материалов на складе.</p>

    <h3>2. Режимы работы</h3>
    <p>Приложение может работать в двух режимах, которые переключаются в <strong>Настройках &rarr; Режим работы</strong>:</p>
    <ul>
        <li><strong>Простой режим (по умолчанию):</strong> Идеален для быстрых расчетов без ведения склада. В этом режиме вкладка "Материал" скрыта. Вы просто добавляете нужные заготовки, а программа анализирует все варианты стандартных длин (указанных в настройках) и предлагает самый экономичный план раскроя.</li>
        <li><strong>Складской режим:</strong> Полноценный режим с учетом материалов на складе, остатков и сортамента. Требует заполнения вкладок "Материал" и "Заготовки". Идеально подходит для ведения полного учета.</li>
    </ul>

    <h3>3. Основные разделы (вкладки)</h3>

    <h4>3.1. Вкладка "Материал" (Складской режим)</h4>
    <p>Здесь вы управляете своим складом — добавляете хлысты и остатки, которые будут использоваться для раскроя. Вкладка доступна только в "Складском режиме".</p>
    <img src="img/instructions/material-tab.png" alt="Вкладка Материал" class="instruction-image">
    <ul>
        <li><strong>Добавление материала:</strong> Выберите Сортамент и Типоразмер, укажите Длину и Количество.</li>
        <li><strong>Остатки:</strong> Если вы добавляете не стандартный хлыст, а полезный остаток с предыдущих раскроев, установите галочку <strong>"Остаток"</strong>.</li>
        <li><strong>Список "На складе":</strong> Отображает все материалы, сгруппированные по типу. Остатки подсвечиваются оранжевым. Вы можете редактировать (<i class="fa-solid fa-pen"></i>) или удалять (<i class="fa-solid fa-xmark"></i>) любую позицию.</li>
    </ul>

    <h4>3.2. Вкладка "Заготовки"</h4>
    <p>На этой вкладке вы формируете список деталей, которые необходимо изготовить.</p>
    <ul>
        <li><strong>Добавление заготовки:</strong>
            <ul class="nested-list">
                <li>В <strong>Складском режиме</strong> укажите Сортамент и Типоразмер, совпадающие с материалом на складе. Заготовки группируются по типу.
                    <img src="img/instructions/parts-tab.png" alt="Вкладка Заготовки (Складской режим)" class="instruction-image">
                </li>
                <li>В <strong>Простом режиме</strong> поля "Сортамент" и "Типоразмер" скрыты, нужно указать только длину и количество.
                    <img src="img/instructions/parts-tab-simple.png" alt="Вкладка Заготовки (Простой режим)" class="instruction-image">
                </li>
            </ul>
        </li>
        <li><strong>Очистка списка:</strong> Кнопка <i class="fa-solid fa-trash-can"></i> в заголовке позволяет удалить все заготовки, относящиеся к текущему режиму работы.</li>
    </ul>

    <h4>3.3. Вкладка "Раскрой"</h4>
    <p>Это главный экран, где происходит расчет, просмотр и редактирование карт раскроя.</p>
    <img src="img/instructions/cutting-tab.png" alt="Вкладка Раскрой" class="instruction-image">
    <ul>
        <li><strong>Расчет:</strong> Нажмите "Рассчитать раскрой" для автоматического создания плана.</li>
        <li><strong>Группировка:</strong> Одинаковые карты раскроя автоматически группируются для компактности (например, "Типовой раскрой x5 шт.").</li>
        <li><strong>Спецификация (<i class="fa-solid fa-list-ul"></i>):</strong> Нажмите на иконку списка в заголовке хлыста, чтобы увидеть перечень деталей. Клик по детали в списке подсветит её на схеме.</li>
        <li><strong>Информация о дефиците:</strong> Если материала не хватило, система покажет, что нужно докупить.</li>
        <li><strong>Лупа:</strong> Эта функция позволяет детально рассмотреть карту раскроя. Для её активации перейдите в <strong>Настройки &rarr; Оформление</strong> и включите опцию "Включить лупу". После этого долгое нажатие (удерживание) на схеме любого хлыста будет открывать увеличенную версию для просмотра.</li>
        <li><strong>Ручное редактирование (<i class="fa-solid fa-pen"></i>):</strong> Нажмите на иконку карандаша в заголовке карточки материала, чтобы перейти в режим редактирования. Это дает полный контроль над раскладкой.</li>
            <ul class="nested-list" style="list-style-type: none; padding-left: 0;">
                <li><strong>Выбор хлыста/группы:</strong> Кликните на хлыст или группу, чтобы выбрать её для добавления деталей. Выбранный элемент подсветится синей рамкой.</li>
                <li><strong>Добавление детали:</strong> Кликните на деталь в списке "Неразмещенные заготовки". Подходящие для нее хлысты подсветятся зеленым. Затем выберите хлыст (или группу), куда ее добавить, и снова кликните на неразмещенную деталь.</li>
                <li><strong>Удаление детали:</strong> Кликните на деталь прямо на визуализации хлыста, чтобы вернуть её в список неразмещенных. Если деталь находится в группе, будут удалены все аналогичные детали из всех хлыстов этой группы.</li>
                <li><i class="fa-solid fa-rotate-left"></i> / <i class="fa-solid fa-rotate-right"></i> <strong>Отменить/Вернуть:</strong> Позволяют отменять и возвращать последние действия в режиме редактирования.</li>
                <li><i class="fa-solid fa-plus"></i> <strong>Добавить хлыст:</strong> Добавляет новый хлыст в план раскроя.</li>
                <li><i class="fa-solid fa-trash"></i> <strong>Очистить план:</strong> Удаляет все хлысты для данного материала, возвращая все детали в неразмещенные.</li>
                <li><i class="fa-solid fa-object-ungroup"></i> <strong>Разгруппировать:</strong> Позволяет редактировать хлысты из типовой группы по отдельности.</li>
                <li><i class="fa-solid fa-object-group"></i> <strong>Сгруппировать:</strong> Позволяет снова объединить одинаковые расклады в типовые группы.</li>
                <li><i class="fa-solid fa-check"></i> <strong>Завершить:</strong> Выход из режима редактирования с автоматической группировкой всех индивидуальных хлыстов.</li>
            </ul>
        <li><strong>Экспорт в PDF (<i class="fa-solid fa-file-pdf"></i>):</strong> После расчета плана, нажмите на иконку PDF в заголовке секции, чтобы сохранить карты раскроя в виде файла. Настройки экспорта находятся на вкладке "Настройки".</li>
        <li><strong>Применение плана (Складской режим):</strong> После того как план готов, нажмите <strong>"Применить и списать материал"</strong>. Это действие спишет использованные хлысты и заготовки со склада и добавит в него новые полезные остатки. Кнопка доступна только в "Складском режиме".</li>
    </ul>

    <h4>3.4. Вкладка "Статистика"</h4>
    <p>Здесь отображается подробная аналитика по последнему выполненному раскрою.</p>
    <img src="img/instructions/stats-tab.png" alt="Вкладка Статистика" class="instruction-image">
    <ul>
        <li><strong>КИМ:</strong> Ключевой показатель — Коэффициент Использования Материала.</li>
        <li><strong>Детализация:</strong> Точные цифры по деталям, остаткам и отходам.</li>
        <li><strong>Статус:</strong> В заголовке указывается, для какого расчета показана статистика: для предварительного или по последнему списанию.</li>
        <li><strong>Дефицит:</strong> Если после расчета остались неразмещенные детали, здесь будет показан подробный список материалов, которые нужно докупить.</li>
    </ul>

    <h4>3.5. Вкладка "Настройки"</h4>
    <p>На этой вкладке вы можете настроить поведение приложения под свои нужды.</p>
    <ul>
        <li><strong>Оформление:</strong> Здесь можно переключить тему между светлой и темной, а также включить или отключить функцию "лупы" для детального просмотра карт раскроя.
            <img src="img/instructions/settings-appearance.png" alt="Настройки: Оформление" class="instruction-image">
        </li>
        <li><strong>Управление сортаментом:</strong> Создавайте свои типы материалов (например, "Труба профильная", "Арматура") и их типоразмеры ("20x20", "12").
            <img src="img/instructions/settings-assortment.png" alt="Настройки: Управление сортаментом" class="instruction-image">
        </li>
        <li><strong>Настройки раскроя:</strong> Здесь задаются ключевые параметры для алгоритма.
            <ul class="nested-list" style="list-style-type: none; padding-left: 0;">
                <li><strong>Ширина реза (kerf):</strong> Толщина пила или резака. Учитывается во всех расчетах.</li>
                <li><strong>Мин. остаток:</strong> Остатки меньше этого значения будут считаться бесполезными отходами.</li>
                <li><strong>Длины для расчета дефицита:</strong> Укажите через запятую длины стандартных хлыстов, которые вы можете купить (например, <code>6000, 12000</code>). Это ключевая настройка для "Простого режима" и для расчета дефицита в обоих режимах.</li>
                <li><strong>Стратегия раскроя:</strong>
                    <ul class="nested-list">
                        <li><strong>Сначала остатки:</strong> Двухэтапная стратегия. Алгоритм в первую очередь пытается разместить как можно больше деталей на остатках со склада. Только после этого для оставшихся деталей подбирается оптимальный раскрой на новых стандартных хлыстах.</li>
                        <li><strong>Минимальный отход:</strong> Комплексная стратегия. Алгоритм рассматривает все доступные хлысты (и стандартные, и остатки) как единый пул и строит из них наиболее эффективный план с наивысшим КИМ.</li>
                    </ul>
                </li>
            </ul>
            <img src="img/instructions/settings-cutting.png" alt="Настройки: Настройки раскроя" class="instruction-image">
        </li>
        <li><strong>Настройки печати (PDF):</strong> Позволяют настроить внешний вид и содержание экспортируемого файла.
            <ul class="nested-list">
                <li><strong>Шаблон имени файла:</strong> Задайте имя файла. Можно использовать переменные: <code>{date}</code>, <code>{time}</code>, <code>{material}</code>.</li>
                <li><strong>Включать неразмещенные детали:</strong> Добавляет на последнюю страницу сводку по деталям, которые не удалось разместить, и расчет дефицита.</li>
                <li><strong>Группировать карты раскроя:</strong> Объединяет одинаковые карты в одну с указанием количества (например, "Типовой раскрой x5 шт.").</li>
                <li><strong>Ориентация страницы:</strong> Выберите книжную или альбомную ориентацию.</li>
                <li><strong>Качество PDF:</strong> Регулирует степень сжатия изображений, влияя на размер и качество файла.</li>
            </ul>
            <img src="img/instructions/settings-print.png" alt="Настройки: Настройки печати" class="instruction-image">
        </li>
        <li><strong>Режим работы:</strong> Позволяет переключаться между "Складским" и "Простым" режимами.
            <img src="img/instructions/settings-mode.png" alt="Настройки: Режим работы" class="instruction-image">
        </li>
    </ul>
</div>